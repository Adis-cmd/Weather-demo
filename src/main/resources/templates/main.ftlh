<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/main.css">
    <title>–ü–æ–≥–æ–¥–∞ -
        <#if weather?? && weather.location?? && weather.location.name?has_content>
            ${weather.location.name}
        <#else>
            -
        </#if>
    </title>
</head>
<body>
<div id="notification" class="notification">
    <div class="notification-content">
        <span class="notification-icon" id="notificationIcon">‚ÑπÔ∏è</span>
        <div class="notification-text">
            <div class="notification-title" id="notificationTitle">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</div>
            <div class="notification-message" id="notificationMessage"></div>
        </div>
        <button class="notification-close" onclick="closeNotification()">‚úï</button>
    </div>
</div>

<div id="loadingOverlay" class="loading-overlay">
    <div class="loading-spinner"></div>
</div>

<div class="container">
    <div class="header">
        <h1>–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã</h1>
        <form class="location-form" action="/" method="get">
            <div class="search-box">
                <input
                        type="text"
                        name="city"
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞..."
                        value="${city!''}"
                        required
                >
                <button type="submit">–ù–∞–π—Ç–∏</button>
            </div>
        </form>
        <button class="auto-detect-btn" onclick="detectLocation()">
            <span>–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</span>
        </button>
    </div>

    <#if weather??>
        <div class="weather-content">
            <div class="location-info">
                <div class="city-name">${weather.location.name}</div>
                <div class="country-name">${weather.location.country}</div>
            </div>

            <div class="weather-main">
                <div>
                    <span class="temperature">${weather.current.temp_c?string("0.0")}</span>
                    <span class="temp-unit">¬∞C</span>
                </div>
                <img src="https:${weather.current.condition.icon}" alt="Weather icon" class="weather-icon">
            </div>

            <div class="condition-text">
                ${weather.current.condition.text}
            </div>

            <div class="weather-details">
                <div class="detail-item">
                    <span class="detail-label">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞</span>
                    <span class="detail-value">${weather.current.temp_c?string("0.0")}¬∞C</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">–°–æ—Å—Ç–æ—è–Ω–∏–µ</span>
                    <span class="detail-value">${weather.current.condition.text}</span>
                </div>
            </div>
        </div>

        <div class="footer">
            –û–±–Ω–æ–≤–ª–µ–Ω–æ: ${.now?string("dd.MM.yyyy HH:mm")}
        </div>
    <#else>
        <div class="weather-content">
            <div class="empty-state">
                <div class="empty-state-icon">
                    <#if error??>
                        ‚ö†Ô∏è
                    <#else>
                        üå°Ô∏è
                    </#if>
                </div>
                <div class="empty-state-title">
                    <#if error??>
                        ${error}
                    <#else>
                        –í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–≥–æ–¥—ã
                    </#if>
                </div>
                <div class="empty-state-message">
                    <#if error??>
                        –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∏–ª–∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –≥–æ—Ä–æ–¥
                    <#else>
                        –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–∏—Å–∫ –≤—ã—à–µ –∏–ª–∏ –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è
                    </#if>
                </div>
            </div>
        </div>
    </#if>
</div>

<script>
    const urlParams = new URLSearchParams(window.location.search);
    const city = urlParams.get('city');

    <#if error?? && city??>
    showNotification('error', '–ì–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω', '–ì–æ—Ä–æ–¥ "${city}" –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∏—è.');
    </#if>
</script>
<script src="/js/main.js"></script>
</body>
</html>